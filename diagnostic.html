<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trendtactics Diagnostic Page</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 40px; }
        .container { background: #fff; border-radius: 12px; max-width: 700px; margin: 0 auto; padding: 32px; box-shadow: 0 4px 16px rgba(0,0,0,0.12); }
        h1 { color: #667eea; }
        pre { background: #f8f9fa; padding: 16px; border-radius: 8px; font-size: 1rem; overflow-x: auto; }
        .section { margin-bottom: 32px; }
        .error { color: #dc3545; font-weight: bold; }
        .success { color: #28a745; font-weight: bold; }
        .info { color: #1976d2; font-weight: bold; }
    </style>
</head>
<body>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <!-- Floating Language Selector -->
    <div id="floating-translate-btn" style="position:fixed;bottom:30px;left:30px;z-index:9999;display:flex;align-items:center;gap:8px;">
        <button id="toggle-translate" style="background:#0A1E3F;color:#00FFFF;border:none;border-radius:50%;width:48px;height:48px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 16px rgba(10,30,63,0.18);cursor:pointer;font-size:1.6rem;transition:background 0.2s;">
            <i class="fas fa-globe"></i>
        </button>
        <div id="floating-translate-widget" style="display:none;"></div>
    </div>
    <div id="google_translate_element" style="display:none;"></div>
    <script>
    // Move Google Translate widget into floating widget and toggle visibility
    document.addEventListener('DOMContentLoaded', function() {
        var translateWidget = document.getElementById('google_translate_element');
        var floatingWidget = document.getElementById('floating-translate-widget');
        var toggleBtn = document.getElementById('toggle-translate');
        if (translateWidget && floatingWidget && toggleBtn) {
            floatingWidget.appendChild(translateWidget);
            toggleBtn.addEventListener('click', function() {
                if (floatingWidget.style.display === 'none' || floatingWidget.style.display === '') {
                    floatingWidget.style.display = 'block';
                } else {
                    floatingWidget.style.display = 'none';
                }
            });
        }
    });
    </script>
    <div class="container">
        <h1>ðŸ©º Trendtactics Diagnostic Page</h1>
        <div class="section">
            <h2>1. Academy.js Version</h2>
            <pre id="js-version">Loading...</pre>
        </div>
        <div class="section">
            <h2>2. Enrollment Data in localStorage</h2>
            <pre id="enrollment-data">Loading...</pre>
        </div>
        <div class="section">
            <h2>3. Global Function Availability</h2>
            <pre id="function-checks">Loading...</pre>
        </div>
        <div class="section">
            <h2>4. JavaScript Errors</h2>
            <pre id="js-errors">No errors yet.</pre>
        </div>
        <div class="section">
            <h2>5. Network Info</h2>
            <pre id="network-info">Loading...</pre>
        </div>
    </div>
    <script src="/js/academy.js?v=2.3.0"></script>
    <script>
    // 1. Print academy.js version
    function getAcademyJsVersion() {
        try {
            const scripts = document.querySelectorAll('script[src*="academy.js"]');
            if (scripts.length) {
                fetch(scripts[0].src)
                    .then(r => r.text())
                    .then(txt => {
                        const versionLine = txt.split('\n')[0];
                        document.getElementById('js-version').textContent = versionLine;
                    })
                    .catch(() => {
                        document.getElementById('js-version').textContent = 'Could not fetch academy.js';
                    });
            } else {
                document.getElementById('js-version').textContent = 'academy.js not loaded.';
            }
        } catch (e) {
            document.getElementById('js-version').textContent = 'Error: ' + e.message;
        }
    }
    getAcademyJsVersion();

    // 2. Print localStorage enrollment data
    function printEnrollmentData() {
        const keys = [
            'enrolledCourse',
            'enrolledLearningPath',
            'studentEmail',
            'studentPassword',
            'rememberMe'
        ];
        let out = '';
        keys.forEach(k => {
            out += k + ': ' + (localStorage.getItem(k) || 'null') + '\n';
        });
        document.getElementById('enrollment-data').textContent = out;
    }
    printEnrollmentData();

    // 3. Check global function availability
    function checkFunctions() {
        const funcs = [
            'enrollInLearningPath',
            'showLearningPathEnrollmentModal',
            'showStudentChoiceModal',
            'processLearningPathEnrollment',
            'enrollAsNewStudent',
            'enrollAsExistingStudent',
            'showNewStudentRegistration',
            'showExistingStudentLogin',
            'processNewStudentRegistration',
            'processExistingStudentLogin',
            'showNotification',
            'closeModal',
            'addModalStyles',
            'getEnrolledCourse',
            'getCurrentLessonIndex',
            'setCurrentLessonIndex',
            'updateDashboardProgress',
            'showDynamicLessonModal',
            'markLessonCompleteReal',
            'clearEnrollmentData'
        ];
        let out = '';
        funcs.forEach(f => {
            out += f + ': ' + (typeof window[f] === 'function' ? 'âœ…' : 'âŒ') + '\n';
        });
        document.getElementById('function-checks').textContent = out;
    }
    checkFunctions();

    // 4. JS error catcher
    let errorLog = [];
    window.onerror = function(msg, src, line, col, err) {
        errorLog.push(msg + ' at ' + src + ':' + line + ':' + col);
        document.getElementById('js-errors').textContent = errorLog.join('\n');
    };

    // 5. Network info
    function printNetworkInfo() {
        let out = '';
        const scripts = document.querySelectorAll('script');
        scripts.forEach(s => {
            if (s.src) out += 'Script: ' + s.src + '\n';
        });
        document.getElementById('network-info').textContent = out;
    }
    printNetworkInfo();
    </script>
</body>
</html> 